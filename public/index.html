<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Premium Operator App</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <style>
        /* আপনার দেওয়া CSS এখানে হুবহু থাকবে */
        :root { --primary-blue: #5865f2; --accent-orange: #ff8c7a; --bg-color: #f8faff; --white: #ffffff; --text-main: #2d3436; --text-muted: #636e72; --robi: #d71921; --gp: #007bc3; --bl: #f48220; --airtel: #ed1c24; --teletalk: #78b833; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
        body { background-color: var(--bg-color); overflow-x: hidden; }
        .main-wrapper { width: 100%; min-height: 100vh; padding-bottom: 100px; }
        .app-header { padding: 30px 20px 15px; display: flex; align-items: center; justify-content: space-between; }
        .profile-section-top { display: flex; align-items: center; gap: 12px; }
        .user-avatar-top { width: 45px; height: 45px; background: #eee; border-radius: 50%; overflow: hidden; border: 2px solid var(--white); box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .user-avatar-top img { width: 100%; height: 100%; object-fit: cover; }
        .balance-card { background: var(--white); margin: 0 20px; padding: 18px 22px; border-radius: 22px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 10px 25px rgba(0,0,0,0.03); }
        .offers-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; padding: 20px; }
        .card { background: var(--white); padding: 22px 15px 15px; border-radius: 22px; position: relative; overflow: hidden; box-shadow: 0 8px 20px rgba(0,0,0,0.02); }
        .op-tag { position: absolute; top: 0; right: 0; padding: 3px 10px; font-size: 8px; color: white; border-bottom-left-radius: 12px; text-transform: uppercase; }
        .price-button { margin-top: 15px; width: 100%; border: none; padding: 10px; border-radius: 12px; background: linear-gradient(135deg, #ff8c7a, #ffb399); color: white; font-weight: 700; }
        .bottom-nav { position: fixed; bottom: 0; width: 100%; background: white; height: 80px; display: flex; justify-content: space-around; align-items: center; border-radius: 30px 30px 0 0; box-shadow: 0 -5px 20px rgba(0,0,0,0.05); }
        #toast { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: #333; color: white; padding: 10px 20px; border-radius: 20px; display: none; z-index: 10000; }
    </style>
</head>
<body>
    <div id="toast">প্রসেসিং...</div>
    <div class="main-wrapper">
        <header class="app-header">
            <div class="profile-section-top">
                <div class="user-avatar-top"><img id="u-img" src="" alt=""></div>
                <div class="user-info-top">
                    <h2 id="u-id">Loading...</h2>
                    <p id="u-name">Please wait</p>
                </div>
            </div>
        </header>

        <div class="balance-card">
            <div class="bal-left"><p>Available Balance</p><h3 id="u-bal">৳ ০.০০</h3></div>
            <div class="add-money-btn" style="background:var(--primary-blue); color:white; padding:8px 15px; border-radius:12px; font-size:12px;">Add Money</div>
        </div>

        <div id="content-area">
            <div class="offers-grid" id="offers-list">
                <!-- অফারগুলো এখান থেকে লোড হবে -->
            </div>
        </div>
    </div>

    <nav class="bottom-nav">
        <div onclick="location.reload()"><i class="fas fa-home"></i></div>
        <div onclick="showToast('History coming soon')"><i class="fas fa-history"></i></div>
        <div onclick="showToast('Account Settings')"><i class="fas fa-user"></i></div>
    </nav>

    <script>
        // Firebase Configuration (Replace with your actual config)
        const firebaseConfig = {
  apiKey: "AIzaSyCbYJQ9y9CJKiT5aJyrIA0pFRGy1uvZikA",
  authDomain: "telicombangla-1.firebaseapp.com",
  projectId: "telicombangla-1",
  storageBucket: "telicombangla-1.firebasestorage.app",
  messagingSenderId: "1020351520674",
  appId: "1:1020351520674:web:c84659bc5ca2f6b41edcfb"
};
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        const tg = window.Telegram.WebApp;
        tg.expand();
        const user = tg.initDataUnsafe?.user;

        if(user) {
            // ইউজারের রিয়েল-টাইম ডাটা লোড
            db.collection('users').doc(user.id.toString()).onSnapshot(doc => {
                if(doc.exists) {
                    const data = doc.data();
                    document.getElementById('u-id').innerText = data.id;
                    document.getElementById('u-name').innerText = data.name;
                    document.getElementById('u-img').src = data.photo;
                    document.getElementById('u-bal').innerText = '৳ ' + data.balance;
                }
            });
        }

        // অফার লোড করা
        db.collection('offers').onSnapshot(snapshot => {
            let html = '';
            snapshot.forEach(doc => {
                const off = doc.data();
                html += `
                <div class="card">
                    <span class="op-tag" style="background:var(--${off.operator.toLowerCase()})">${off.operator}</span>
                    <div style="font-weight:700; font-size:11px;">${off.title}</div>
                    <div style="font-size:9px; color:#666;">${off.validity}</div>
                    <button class="price-button" onclick="buy('${doc.id}')">৳ ${off.price}</button>
                </div>`;
            });
            document.getElementById('offers-list').innerHTML = html;
        });

        function showToast(m) { 
            const t = document.getElementById('toast'); 
            t.innerText = m; t.style.display = 'block'; 
            setTimeout(() => t.style.display = 'none', 2000); 
        }

        function buy(id) { showToast('অর্ডার প্রসেসিং হচ্ছে...'); }
    </script>
</body>
</html>
